
--------------------------- INFLUXDB ---------------------------

wget https://dl.influxdata.com/influxdb/releases/influxdb_1.8.10_amd64.deb && dpkg -i influxdb_1.8.10_amd64.deb

systemctl enable influxdb && systemctl start influxdb

*** Package archive: https://repos.influxdata.com/ubuntu/packages/ ***


# influx
    > CREATE DATABASE telegraf
    > CREATE USER influx WITH PASSWORD 'pms18project'
    
    

--------------------------- TELEGRAF ---------------------------


wget https://repos.influxdata.com/ubuntu/packages/telegraf_1.23.3-1_amd64.deb && dpkg -i telegraf_1.23.3-1_amd64.deb

systemctl start telegraf && systemctl enable telegraf
systemctl status telegraf


nano /etc/telegraf/telegraf.conf

[...]

systemctl status telegraf
systemctl restart telegraf

VERIFY TELEGRAF:
    sudo telegraf -test -config /etc/telegraf/telegraf.conf — input-filter cpu  
    sudo telegraf -test -config /etc/telegraf/telegraf.conf — input-filter net
    sudo telegraf -test -config /etc/telegraf/telegraf.conf — input-filter mem



--------------------------- OWNCLOUD ---------------------------

### COMPATIBLE WITH PHP 7.4 ONLY ###

1) LAMP SERVER INSTALLATION (maybe not needed)
    apt update
    apt install lamp-server^ -y
    systemctl start apache2 && systemctl enable apache2
    
    *The above installs PHP 8.1, which is incompatible with Owncloud. Purge PHP and install version 7.4 from bellow*
    
    apt-get purge 'php*' 

2) PHP INSTALL
    sudo apt -y install software-properties-common
    sudo add-apt-repository ppa:ondrej/php -y
    sudo apt-get update
    sudo apt -y install php7.4 php7.4-cli php7.4-json php7.4-common php7.4-mysql php7.4-zip php7.4-gd php7.4-mbstring php7.4-curl php7.4-xml php7.4-bcmath php7.4-intl
   

3) MYSQL SETUP

    ### IMPORTANT ! -> https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-ubuntu-20-04 ###
    
    sudo mysql --user=root -p

    CREATE DATABASE ownclouddb;
    
    CREATE USER 'ownclouduser'@'localhost' IDENTIFIED BY 'pms18project';
    
    Grant the new user with the necessary privileges:
    GRANT ALL ON ownclouddb.* TO 'ownclouduser'@'localhost' WITH GRANT OPTION;
    
    Enable changes by flushing the privileges:
    FLUSH PRIVILEGES;
    
    exit

4)OWNCLOUD PACKAGE DOWNLOAD 
    wget https://download.owncloud.com/server/stable/owncloud-complete-latest.tar.bz2
    tar -xjvf owncloud-complete-latest.tar.bz2
    mv owncloud /var/www/
    chown -R www-data: /var/www/owncloud
    
    
    nano /etc/apache2/sites-available/owncloud.conf
    
    Paste bellow text into new file:
        <VirtualHost *:80>
            ServerName [your_VM_IP]
            DocumentRoot /var/www/owncloud
        </VirtualHost>
    
    Enable configuration file:
        a2ensite owncloud.conf
    
    systemctl restart apache2


-------------------------------------------------------------------



https://www.howtoforge.com/tutorial/how-to-install-tig-stack-telegraf-influxdb-and-grafana-on-ubuntu-1804/
https://www.techpowerup.com/forums/threads/guide-setting-up-and-implementing-a-tig-stack.255940/
https://medium.com/@hoanglc/tig-stack-powerful-monitoring-tool-822521dce102

https://grafana.com/grafana/dashboards/3387-process-top/

https://www.linode.com/docs/guides/install-and-configure-owncloud-on-ubuntu-20-04/
https://lucidar.me/en/owncloud/install-owncloud-server-on-ubuntu-20-04/
https://ostechnix.com/fix-mysql-error-1819-hy000-your-password-does-not-satisfy-the-current-policy-requirements/
https://www.rosehosting.com/blog/how-to-install-lamp-with-php-7-4-on-ubuntu-20-04/
https://doc.owncloud.com/server/10.12/admin_manual/maintenance/migrating.html#managing-trusted-domains


-----

#!/bin/bash

sudo dd of=/etc/apache2/sites-available/owncloud.conf << EOF
<VirtualHost *:80>
  ServerName localhost
  DocumentRoot /var/www/localhost
</VirtualHost>
EOF



-----



#!/bin/bash

influx <<EOF
CREATE DATABASE influx;
CREATE USER telegraf WITH PASSWORD 'pms18project';
EOF


-----


#!/bin/bash

sudo mysql --user=root -p <<EOF
CREATE DATABASE ownclouddb;
CREATE USER 'ownclouduser'@'localhost' IDENTIFIED BY 'pms18project';
GRANT ALL ON ownclouddb.* TO 'ownclouduser'@'localhost' WITH GRANT OPTION;
FLUSH PRIVILEGES;
exit
EOF


---------


 [[inputs.exec]]
   commands = ["top -b -n 1"]
   name_override = "linux_top"
   data_format = "value"
   data_type = "string"


